<!doctype html><html lang="en"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>stock.rule - odocgen</title><link rel="stylesheet" href="class.css" /></head><body><h1>stock.rule</h1><p>Originally defined in: odoo/addons/stock/models/stock_rule.py</p><p>Inherited in: odoo/addons/stock_dropshipping/models/stock.py<br/>Inherited in: odoo/addons/sale_stock/models/stock.py<br/>Inherited in: odoo/addons/purchase_stock/models/stock_rule.py<br/>Inherited in: odoo/addons/purchase_requisition_stock/models/stock.py<br/>Inherited in: odoo/addons/point_of_sale/models/stock_rule.py<br/>Inherited in: odoo/addons/mrp_subcontracting_purchase/models/stock_rule.py<br/>Inherited in: odoo/addons/mrp_subcontracting_dropshipping/models/stock_rule.py<br/>Inherited in: odoo/addons/mrp_subcontracting/models/stock_rule.py<br/>Inherited in: odoo/addons/mrp_account/models/stock_rule.py<br/>Inherited in: odoo/addons/mrp/models/stock_rule.py<br/></p><hr/><h2>Original: odoo/addons/stock/models/stock_rule.py</h2><h3>Fields</h3><details><summary id="f-action">action <span class="position">@ line 54</span></summary><pre>action = fields.Selection(
        selection=[('pull', 'Pull From'), ('push', 'Push To'), ('pull_push', 'Pull & Push')], string='Action',
        required=True, index=True)</pre></details><details><summary id="f-active">active <span class="position">@ line 46</span></summary><pre>active = fields.Boolean(
        'Active', default=True,
        help="If unchecked, it will allow you to hide the rule without removing it.")</pre></details><details><summary id="f-auto">auto <span class="position">@ line 98</span></summary><pre>auto = fields.Selection([
        ('manual', 'Manual Operation'),
        ('transparent', 'Automatic No Step Added')], string='Automatic Move',
        default='manual', required=True,
        help="The 'Manual Operation' value will create a stock move after the current one. "
             "With 'Automatic No Step Added', the location is replaced in the original move.")</pre></details><details><summary id="f-company_id">company_id <span class="position">@ line 58</span></summary><pre>company_id = fields.Many2one('res.company', 'Company',
        default=lambda self: self.env.company,
        domain="[('id', '=?', route_company_id)]")</pre></details><details><summary id="f-delay">delay <span class="position">@ line 83</span></summary><pre>delay = fields.Integer('Lead Time', default=0, help="The expected date of the created transfer will be computed based on this lead time.")</pre></details><details><summary id="f-group_id">group_id <span class="position">@ line 53</span></summary><pre>group_id = fields.Many2one('procurement.group', 'Fixed Procurement Group')</pre></details><details><summary id="f-group_propagation_option">group_propagation_option <span class="position">@ line 49</span></summary><pre>group_propagation_option = fields.Selection([
        ('none', 'Leave Empty'),
        ('propagate', 'Propagate'),
        ('fixed', 'Fixed')], string="Propagation of Procurement Group", default='propagate')</pre></details><details><summary id="f-location_dest_from_rule">location_dest_from_rule <span class="position">@ line 63</span></summary><pre>location_dest_from_rule = fields.Boolean(
        "Destination location origin from rule", default=False,
        help="When set to True the destination location of the stock.move will be the rule."
        "Otherwise, it takes it from the picking type.")</pre></details><details><summary id="f-location_dest_id">location_dest_id <span class="position">@ line 61</span></summary><pre>location_dest_id = fields.Many2one('stock.location', 'Destination Location', required=True, check_company=True, index=True)</pre></details><details><summary id="f-location_src_id">location_src_id <span class="position">@ line 62</span></summary><pre>location_src_id = fields.Many2one('stock.location', 'Source Location', check_company=True, index=True)</pre></details><details><summary id="f-name">name <span class="position">@ line 43</span></summary><pre>name = fields.Char(
        'Name', required=True, translate=True,
        help="This field will fill the packing origin and the name of its moves")</pre></details><details><summary id="f-partner_address_id">partner_address_id <span class="position">@ line 84</span></summary><pre>partner_address_id = fields.Many2one(
        'res.partner', 'Partner Address',
        check_company=True,
        help="Address where goods should be delivered. Optional.")</pre></details><details><summary id="f-picking_type_code_domain">picking_type_code_domain <span class="position">@ line 82</span></summary><pre>picking_type_code_domain = fields.Char(compute='_compute_picking_type_code_domain')</pre></details><details><summary id="f-picking_type_id">picking_type_id <span class="position">@ line 78</span></summary><pre>picking_type_id = fields.Many2one(
        'stock.picking.type', 'Operation Type',
        required=True, check_company=True,
        domain="[('code', '=?', picking_type_code_domain)]")</pre></details><details><summary id="f-procure_method">procure_method <span class="position">@ line 69</span></summary><pre>procure_method = fields.Selection([
        ('make_to_stock', 'Take From Stock'),
        ('make_to_order', 'Trigger Another Rule'),
        ('mts_else_mto', 'Take From Stock, if unavailable, Trigger Another Rule')], string='Supply Method', default='make_to_stock', required=True,
        help="Take From Stock: the products will be taken from the available stock of the source location.\n"
             "Trigger Another Rule: the system will try to find a stock rule to bring the products in the source location. The available stock will be ignored.\n"
             "Take From Stock, if Unavailable, Trigger Another Rule: the products will be taken from the available stock of the source location."
             "If there is no stock available, the system will try to find a  rule to bring the products in the source location.")</pre></details><details><summary id="f-propagate_cancel">propagate_cancel <span class="position">@ line 88</span></summary><pre>propagate_cancel = fields.Boolean(
        'Cancel Next Move', default=False,
        help="When ticked, if the move created by this rule is cancelled, the next move will be cancelled too.")</pre></details><details><summary id="f-propagate_carrier">propagate_carrier <span class="position">@ line 91</span></summary><pre>propagate_carrier = fields.Boolean(
        'Propagation of carrier', default=False,
        help="When ticked, carrier of shipment will be propagated.")</pre></details><details><summary id="f-propagate_warehouse_id">propagate_warehouse_id <span class="position">@ line 95</span></summary><pre>propagate_warehouse_id = fields.Many2one(
        'stock.warehouse', 'Warehouse to Propagate',
        help="The warehouse to propagate on the created move/procurement, which can be different of the warehouse this rule is for (e.g for resupplying rules from another warehouse)")</pre></details><details><summary id="f-route_company_id">route_company_id <span class="position">@ line 68</span></summary><pre>route_company_id = fields.Many2one(related='route_id.company_id', string='Route Company')</pre></details><details><summary id="f-route_id">route_id <span class="position">@ line 67</span></summary><pre>route_id = fields.Many2one('stock.route', 'Route', required=True, ondelete='cascade', index=True)</pre></details><details><summary id="f-route_sequence">route_sequence <span class="position">@ line 77</span></summary><pre>route_sequence = fields.Integer('Route Sequence', related='route_id.sequence', store=True, compute_sudo=True)</pre></details><details><summary id="f-rule_message">rule_message <span class="position">@ line 104</span></summary><pre>rule_message = fields.Html(compute='_compute_action_message')</pre></details><details><summary id="f-sequence">sequence <span class="position">@ line 57</span></summary><pre>sequence = fields.Integer('Sequence', default=20)</pre></details><details><summary id="f-warehouse_id">warehouse_id <span class="position">@ line 94</span></summary><pre>warehouse_id = fields.Many2one('stock.warehouse', 'Warehouse', check_company=True, index=True)</pre></details><h3>Methods</h3><details><summary id="m-_get_custom_move_fields">_get_custom_move_fields(self) <span class="position">@ line 311</span></summary><pre>The purpose of this method is to be override in order to easily add
fields from procurement 'values' argument to move data.</pre></details><details><summary id="m-_get_lead_days">_get_lead_days(self, product) <span class="position">@ line 393</span></summary><pre>Returns the cumulative delay and its description encountered by a
procurement going through the rules in `self`.

:param product: the product of the procurement
:type product: :class:`~odoo.addons.product.models.product.ProductProduct`
:return: the cumulative delay and cumulative delay's description
:rtype: tuple[defaultdict(float), list[str, str]]</pre></details><details><summary id="m-_get_message_dict">_get_message_dict(self) <span class="position">@ line 154</span></summary><pre>Return a dict with the different possible message used for the
rule message. It should return one message for each stock.rule action
(except push and pull). This function is override in mrp and
purchase_stock in order to complete the dictionary.</pre></details><details><summary id="m-_get_message_values">_get_message_values(self) <span class="position">@ line 143</span></summary><pre>Return the source, destination and picking_type applied on a stock
rule. The purpose of this function is to avoid code duplication in
_get_message_dict functions since it often requires those data.</pre></details><details><summary id="m-_get_stock_move_values">_get_stock_move_values(self, product_id, product_qty, product_uom, location_dest_id, name, origin, company_id, values) <span class="position">@ line 317</span></summary><pre>Returns a dictionary of values that will be used to create a stock move from a procurement.
This function assumes that the given procurement has a rule (action == 'pull' or 'pull_push') set on it.

:param procurement: browse record
:rtype: dictionary</pre></details><ul id="m-_push_prepare_move_copy_values"><li>_push_prepare_move_copy_values(self, move_to_copy, new_date) <span class="position">@ line 235</span></li></ul><details><summary id="m-_run_push">_run_push(self, move) <span class="position">@ line 204</span></summary><pre>Apply a push rule on a move.
If the rule is 'no step added' it will modify the destination location
on the move.
If the rule is 'manual operation' it will generate a new move in order
to complete the section define by the rule.
Care this function is not call by method run. It is called explicitely
in stock_move.py inside the method _push_apply</pre></details><ul id="m-copy_data"><li>copy_data(self, default) <span class="position">@ line 106</span></li></ul><h2>Inherited: odoo/addons/sale_stock/models/stock.py</h2><h3>Methods</h3><ul id="m-_get_custom_move_fields"><li>_get_custom_move_fields(self) <span class="position">@ line 77</span></li></ul><h2>Inherited: odoo/addons/purchase_stock/models/stock_rule.py</h2><h3>Fields</h3><details><summary id="f-action">action <span class="position">@ line 17</span></summary><pre>action = fields.Selection(selection_add=[
        ('buy', 'Buy')
    ], ondelete={'buy': 'cascade'})</pre></details><h3>Methods</h3><details><summary id="m-_get_lead_days">_get_lead_days(self, product) <span class="position">@ line 157</span></summary><pre>Add the company security lead time and the supplier delay to the cumulative delay
and cumulative description. The company lead time is always displayed for onboarding
purpose in order to indicate that those options are available.</pre></details><ul id="m-_get_message_dict"><li>_get_message_dict(self) <span class="position">@ line 21</span></li></ul><ul id="m-_make_po_get_domain"><li>_make_po_get_domain(self, company_id, values, partner) <span class="position">@ line 302</span></li></ul><details><summary id="m-_prepare_purchase_order">_prepare_purchase_order(self, company_id, origins, values) <span class="position">@ line 267</span></summary><pre>Create a purchase order for procuremets that share the same domain
returned by _make_po_get_domain.
params values: values of procurements
params origins: procuremets origins to write on the PO</pre></details><ul id="m-_push_prepare_move_copy_values"><li>_push_prepare_move_copy_values(self, move_to_copy, new_date) <span class="position">@ line 326</span></li></ul><ul id="m-_update_purchase_order_line"><li>_update_purchase_order_line(self, product_id, product_qty, product_uom, company_id, values, line) <span class="position">@ line 243</span></li></ul><h2>Inherited: odoo/addons/purchase_requisition_stock/models/stock.py</h2><h3>Methods</h3><ul id="m-_make_po_get_domain"><li>_make_po_get_domain(self, company_id, values, partner) <span class="position">@ line 19</span></li></ul><ul id="m-_prepare_purchase_order"><li>_prepare_purchase_order(self, company_id, origins, values) <span class="position">@ line 10</span></li></ul><h2>Inherited: odoo/addons/point_of_sale/models/stock_rule.py</h2><h3>Methods</h3><ul id="m-_get_stock_move_values"><li>_get_stock_move_values(self, product_id, product_qty, product_uom, location_id, name, origin, company_id, values) <span class="position">@ line 11</span></li></ul><h2>Inherited: odoo/addons/mrp_subcontracting_purchase/models/stock_rule.py</h2><h3>Methods</h3><details><summary id="m-_get_lead_days">_get_lead_days(self, product) <span class="position">@ line 7</span></summary><pre>For subcontracting, we need to consider both vendor lead time and
manufacturing lead time, and DTPMO (Days To Prepare MO).
Subcontracting delay =
max(Vendor lead time, Manufacturing lead time + DTPMO) + Days to Purchase + Purchase security lead time</pre></details><h2>Inherited: odoo/addons/mrp_subcontracting_dropshipping/models/stock_rule.py</h2><h3>Methods</h3><ul id="m-_make_po_get_domain"><li>_make_po_get_domain(self, company_id, values, partner) <span class="position">@ line 17</span></li></ul><ul id="m-_prepare_purchase_order"><li>_prepare_purchase_order(self, company_id, origins, values) <span class="position">@ line 10</span></li></ul><h2>Inherited: odoo/addons/mrp_subcontracting/models/stock_rule.py</h2><h3>Methods</h3><ul id="m-_push_prepare_move_copy_values"><li>_push_prepare_move_copy_values(self, move_to_copy, new_date) <span class="position">@ line 10</span></li></ul><h2>Inherited: odoo/addons/mrp_account/models/stock_rule.py</h2><h3>Methods</h3><ul id="m-_prepare_mo_vals"><li>_prepare_mo_vals(self, product_id, product_qty, product_uom, location_id, name, origin, company_id, values, bom) <span class="position">@ line 10</span></li></ul><h2>Inherited: odoo/addons/mrp/models/stock_rule.py</h2><h3>Fields</h3><details><summary id="f-action">action <span class="position">@ line 15</span></summary><pre>action = fields.Selection(selection_add=[
        ('manufacture', 'Manufacture')
    ], ondelete={'manufacture': 'cascade'})</pre></details><h3>Methods</h3><ul id="m-_get_custom_move_fields"><li>_get_custom_move_fields(self) <span class="position">@ line 145</span></li></ul><ul id="m-_get_date_planned"><li>_get_date_planned(self, bom_id, values) <span class="position">@ line 192</span></li></ul><details><summary id="m-_get_lead_days">_get_lead_days(self, product) <span class="position">@ line 199</span></summary><pre>Add the product and company manufacture delay to the cumulative delay
and cumulative description.</pre></details><ul id="m-_get_matching_bom"><li>_get_matching_bom(self, product_id, company_id, values) <span class="position">@ line 150</span></li></ul><ul id="m-_get_message_dict"><li>_get_message_dict(self) <span class="position">@ line 19</span></li></ul><ul id="m-_prepare_mo_vals"><li>_prepare_mo_vals(self, product_id, product_qty, product_uom, location_dest_id, name, origin, company_id, values, bom) <span class="position">@ line 157</span></li></ul><ul id="m-_push_prepare_move_copy_values"><li>_push_prepare_move_copy_values(self, move_to_copy, new_date) <span class="position">@ line 238</span></li></ul><ul id="m-_should_auto_confirm_procurement_mo"><li>_should_auto_confirm_procurement_mo(self, p) <span class="position">@ line 38</span></li></ul><script src="class.js"></script></body></html>
