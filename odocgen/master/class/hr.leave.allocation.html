<!doctype html><html lang="en"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>hr.leave.allocation - odocgen</title><link rel="stylesheet" href="class.css" /></head><body><h1>hr.leave.allocation</h1><p>Inherited in: odoo/addons/hr_holidays_attendance/models/hr_leave_allocation.py<br/>Inherited in: odoo/addons/hr_holidays/models/hr_leave_allocation.py<br/></p><hr/><h2>Inherited: odoo/addons/hr_holidays_attendance/models/hr_leave_allocation.py</h2><h3>Fields</h3><details><summary id="f-employee_overtime">employee_overtime <span class="position">@ line 27</span></summary><pre>employee_overtime = fields.Float(related='employee_id.total_overtime', groups='base.group_user')</pre></details><details><summary id="f-hr_attendance_overtime">hr_attendance_overtime <span class="position">@ line 28</span></summary><pre>hr_attendance_overtime = fields.Boolean(related='employee_company_id.hr_attendance_overtime')</pre></details><details><summary id="f-overtime_deductible">overtime_deductible <span class="position">@ line 25</span></summary><pre>overtime_deductible = fields.Boolean(compute='_compute_overtime_deductible')</pre></details><details><summary id="f-overtime_id">overtime_id <span class="position">@ line 26</span></summary><pre>overtime_id = fields.Many2one('hr.attendance.overtime', string='Extra Hours', groups='hr_holidays.group_hr_holidays_user')</pre></details><h3>Methods</h3><ul id="m-_get_accrual_plan_level_work_entry_prorata"><li>_get_accrual_plan_level_work_entry_prorata(self, level, start_period, start_date, end_period, end_date) <span class="position">@ line 71</span></li></ul><ul id="m-action_refuse"><li>action_refuse(self) <span class="position">@ line 66</span></li></ul><ul id="m-default_get"><li>default_get(self, fields) <span class="position">@ line 14</span></li></ul><ul id="m-write"><li>write(self, vals) <span class="position">@ line 52</span></li></ul><h2>Inherited: odoo/addons/hr_holidays/models/hr_leave_allocation.py</h2><h3>Fields</h3><details><summary id="f-accrual_plan_id">accrual_plan_id <span class="position">@ line 128</span></summary><pre>accrual_plan_id = fields.Many2one('hr.leave.accrual.plan',
        compute="_compute_from_holiday_status_id", store=True, readonly=False, tracking=True,
        domain="['|', ('time_off_type_id', '=', False), ('time_off_type_id', '=', holiday_status_id)]")</pre></details><details><summary id="f-active_employee">active_employee <span class="position">@ line 67</span></summary><pre>active_employee = fields.Boolean('Active Employee', related='employee_id.active', readonly=True)</pre></details><details><summary id="f-allocation_type">allocation_type <span class="position">@ line 123</span></summary><pre>allocation_type = fields.Selection([
        ('regular', 'Regular Allocation'),
        ('accrual', 'Accrual Allocation')
    ], string="Allocation Type", default="regular", required=True, readonly=True)</pre></details><details><summary id="f-already_accrued">already_accrued <span class="position">@ line 122</span></summary><pre>already_accrued = fields.Boolean()</pre></details><details><summary id="f-approver_id">approver_id <span class="position">@ line 85</span></summary><pre>approver_id = fields.Many2one(
        'hr.employee', string='First Approval', readonly=True, copy=False,
        help='This area is automatically filled by the user who validates the allocation')</pre></details><details><summary id="f-can_approve">can_approve <span class="position">@ line 89</span></summary><pre>can_approve = fields.Boolean('Can Approve', compute='_compute_can_approve')</pre></details><details><summary id="f-category_id">category_id <span class="position">@ line 117</span></summary><pre>category_id = fields.Many2one(
        'hr.employee.category', compute='_compute_from_holiday_type', store=True, string='Employee Tag', readonly=False)</pre></details><details><summary id="f-date_from">date_from <span class="position">@ line 57</span></summary><pre>date_from = fields.Date('Start Date', index=True, copy=False, default=fields.Date.context_today,
        tracking=True, required=True)</pre></details><details><summary id="f-date_to">date_to <span class="position">@ line 59</span></summary><pre>date_to = fields.Date('End Date', copy=False, tracking=True)</pre></details><details><summary id="f-department_id">department_id <span class="position">@ line 114</span></summary><pre>department_id = fields.Many2one(
        'hr.department', compute='_compute_department_id', store=True, string='Department',
        readonly=False)</pre></details><details><summary id="f-duration_display">duration_display <span class="position">@ line 80</span></summary><pre>duration_display = fields.Char('Allocated (Days/Hours)', compute='_compute_duration_display',
        help="Field allowing to see the allocation duration in days or hours depending on the type_request_unit")</pre></details><details><summary id="f-employee_company_id">employee_company_id <span class="position">@ line 66</span></summary><pre>employee_company_id = fields.Many2one(related='employee_id.company_id', readonly=True, store=True)</pre></details><details><summary id="f-employee_id">employee_id <span class="position">@ line 64</span></summary><pre>employee_id = fields.Many2one(
        'hr.employee', compute='_compute_from_employee_ids', store=True, string='Employee', index=True, readonly=False, ondelete="restrict", tracking=True)</pre></details><details><summary id="f-employee_ids">employee_ids <span class="position">@ line 106</span></summary><pre>employee_ids = fields.Many2many(
        'hr.employee', compute='_compute_from_holiday_type', store=True, string='Employees',
        domain=lambda self: [('company_id', 'in', self.env.companies.ids)], readonly=False)</pre></details><details><summary id="f-has_accrual_plan">has_accrual_plan <span class="position">@ line 133</span></summary><pre>has_accrual_plan = fields.Boolean(compute='_compute_has_accrual_plan', string='Accrual Plan Available')</pre></details><details><summary id="f-holiday_status_id">holiday_status_id <span class="position">@ line 60</span></summary><pre>holiday_status_id = fields.Many2one(
        "hr.leave.type", compute='_compute_holiday_status_id', store=True, string="Time Off Type", required=True, readonly=False,
        domain=_domain_holiday_status_id,
        default=_default_holiday_status_id)</pre></details><details><summary id="f-holiday_type">holiday_type <span class="position">@ line 96</span></summary><pre>holiday_type = fields.Selection([
        ('employee', 'By Employee'),
        ('company', 'By Company'),
        ('department', 'By Department'),
        ('category', 'By Employee Tag')],
        string='Allocation Mode', readonly=False, required=True, default='employee',
        help="Allow to create requests in batchs:\n- By Employee: for a specific employee"
             "\n- By Company: all employees of the specified company"
             "\n- By Department: all employees of the specified department"
             "\n- By Employee Tag: all employees of the specific employee group category")</pre></details><details><summary id="f-is_officer">is_officer <span class="position">@ line 127</span></summary><pre>is_officer = fields.Boolean(compute='_compute_is_officer')</pre></details><details><summary id="f-lastcall">lastcall <span class="position">@ line 120</span></summary><pre>lastcall = fields.Date("Date of the last accrual allocation", readonly=True)</pre></details><details><summary id="f-leaves_taken">leaves_taken <span class="position">@ line 132</span></summary><pre>leaves_taken = fields.Float(compute='_compute_leaves', string='Time off Taken')</pre></details><details><summary id="f-linked_request_ids">linked_request_ids <span class="position">@ line 84</span></summary><pre>linked_request_ids = fields.One2many('hr.leave.allocation', 'parent_id', string='Linked Requests')</pre></details><details><summary id="f-manager_id">manager_id <span class="position">@ line 68</span></summary><pre>manager_id = fields.Many2one('hr.employee', compute='_compute_manager_id', store=True, string='Manager')</pre></details><details><summary id="f-max_leaves">max_leaves <span class="position">@ line 131</span></summary><pre>max_leaves = fields.Float(compute='_compute_leaves')</pre></details><details><summary id="f-mode_company_id">mode_company_id <span class="position">@ line 112</span></summary><pre>mode_company_id = fields.Many2one(
        'res.company', compute='_compute_from_holiday_type', store=True, string='Company Mode', readonly=False)</pre></details><details><summary id="f-multi_employee">multi_employee <span class="position">@ line 109</span></summary><pre>multi_employee = fields.Boolean(
        compute='_compute_from_employee_ids', store=True,
        help='Holds whether this allocation concerns more than 1 employee')</pre></details><details><summary id="f-name">name <span class="position">@ line 40</span></summary><pre>name = fields.Char(
        string='Description',
        compute='_compute_description',
        inverse='_inverse_description',
        search='_search_description',
        compute_sudo=False)</pre></details><details><summary id="f-name_validity">name_validity <span class="position">@ line 46</span></summary><pre>name_validity = fields.Char('Description with validity', compute='_compute_description_validity')</pre></details><details><summary id="f-nextcall">nextcall <span class="position">@ line 121</span></summary><pre>nextcall = fields.Date("Date of the next accrual allocation", readonly=True, default=False)</pre></details><details><summary id="f-notes">notes <span class="position">@ line 69</span></summary><pre>notes = fields.Text('Reasons', readonly=False)</pre></details><details><summary id="f-number_of_days">number_of_days <span class="position">@ line 71</span></summary><pre>number_of_days = fields.Float(
        'Number of Days', compute='_compute_from_holiday_status_id', store=True, readonly=False, tracking=True, default=1,
        help='Duration in days. Reference field to use when necessary.')</pre></details><details><summary id="f-number_of_days_display">number_of_days_display <span class="position">@ line 74</span></summary><pre>number_of_days_display = fields.Float(
        'Duration (days)', compute='_compute_number_of_days_display',
        help="For an Accrual Allocation, this field contains the theorical amount of time given to the employee, due to a previous start date, on the first run of the plan. This can be manually edited.")</pre></details><details><summary id="f-number_of_hours_display">number_of_hours_display <span class="position">@ line 77</span></summary><pre>number_of_hours_display = fields.Float(
        'Duration (hours)', compute='_compute_number_of_hours_display', store=True,
        help="For an Accrual Allocation, this field contains the theorical amount of time given to the employee, due to a previous start date, on the first run of the plan. This can be manually edited.")</pre></details><details><summary id="f-parent_id">parent_id <span class="position">@ line 83</span></summary><pre>parent_id = fields.Many2one('hr.leave.allocation', string='Parent')</pre></details><details><summary id="f-private_name">private_name <span class="position">@ line 47</span></summary><pre>private_name = fields.Char('Allocation Description', groups='hr_holidays.group_hr_holidays_user')</pre></details><details><summary id="f-state">state <span class="position">@ line 48</span></summary><pre>state = fields.Selection([
        ('confirm', 'To Approve'),
        ('refuse', 'Refused'),
        ('validate', 'Approved')],
        string='Status', readonly=True, tracking=True, copy=False, default='confirm',
        help="The status is set to 'To Submit', when an allocation request is created."
        "\nThe status is 'To Approve', when an allocation request is confirmed by user."
        "\nThe status is 'Refused', when an allocation request is refused by manager."
        "\nThe status is 'Approved', when an allocation request is approved by manager.")</pre></details><details><summary id="f-type_request_unit">type_request_unit <span class="position">@ line 90</span></summary><pre>type_request_unit = fields.Selection([
        ('hour', 'Hours'),
        ('half_day', 'Half Day'),
        ('day', 'Day'),
    ], compute="_compute_type_request_unit")</pre></details><details><summary id="f-validation_type">validation_type <span class="position">@ line 88</span></summary><pre>validation_type = fields.Selection(string='Validation Type', related='holiday_status_id.allocation_validation_type', readonly=True)</pre></details><h3>Methods</h3><ul id="m-_action_validate_create_childs"><li>_action_validate_create_childs(self) <span class="position">@ line 757</span></li></ul><ul id="m-_add_days_to_allocation"><li>_add_days_to_allocation(self, current_level, current_level_maximum_leave, leaves_taken, period_start, period_end) <span class="position">@ line 376</span></li></ul><ul id="m-_add_lastcalls"><li>_add_lastcalls(self) <span class="position">@ line 627</span></li></ul><details><summary id="m-_check_approval_update">_check_approval_update(self, state) <span class="position">@ line 802</span></summary><pre>Check if target state is achievable.</pre></details><ul id="m-_default_holiday_status_id"><li>_default_holiday_status_id(self) <span class="position">@ line 28</span></li></ul><ul id="m-_domain_holiday_status_id"><li>_domain_holiday_status_id(self) <span class="position">@ line 35</span></li></ul><ul id="m-_get_accrual_plan_level_work_entry_prorata"><li>_get_accrual_plan_level_work_entry_prorata(self, level, start_period, start_date, end_period, end_date) <span class="position">@ line 413</span></li></ul><ul id="m-_get_carryover_date"><li>_get_carryover_date(self, date_from) <span class="position">@ line 361</span></li></ul><details><summary id="m-_get_current_accrual_plan_level_id">_get_current_accrual_plan_level_id(self, date, level_ids) <span class="position">@ line 383</span></summary><pre>Returns a pair (accrual_plan_level, idx) where accrual_plan_level is the level for the given date
and idx is the index for the plan in the ordered set of levels</pre></details><ul id="m-_get_future_leaves_on"><li>_get_future_leaves_on(self, accrual_date) <span class="position">@ line 563</span></li></ul><ul id="m-_get_redirect_suggested_company"><li>_get_redirect_suggested_company(self) <span class="position">@ line 721</span></li></ul><ul id="m-_get_request_unit"><li>_get_request_unit(self) <span class="position">@ line 347</span></li></ul><ul id="m-_get_responsible_for_approval"><li>_get_responsible_for_approval(self) <span class="position">@ line 855</span></li></ul><ul id="m-_inverse_description"><li>_inverse_description(self) <span class="position">@ line 182</span></li></ul><details><summary id="m-_notify_get_recipients_groups">_notify_get_recipients_groups(self, message, model_description, msg_vals) <span class="position">@ line 908</span></summary><pre>Handle HR users and officers recipients that can validate or refuse holidays
directly from email.</pre></details><ul id="m-_prepare_holiday_values"><li>_prepare_holiday_values(self, employees) <span class="position">@ line 728</span></li></ul><details><summary id="m-_process_accrual_plan_level">_process_accrual_plan_level(self, level, start_period, start_date, end_period, end_date) <span class="position">@ line 438</span></summary><pre>Returns the added days for that level</pre></details><details><summary id="m-_process_accrual_plans">_process_accrual_plans(self, date_to, force_period, log) <span class="position">@ line 458</span></summary><pre>This method is part of the cron's process.
The goal of this method is to retroactively apply accrual plan levels and progress from nextcall to date_to or today.
If force_period is set, the accrual will run until date_to in a prorated way (used for end of year accrual actions).</pre></details><ul id="m-_search_description"><li>_search_description(self, operator, value) <span class="position">@ line 188</span></li></ul><ul id="m-_track_subtype"><li>_track_subtype(self, init_values) <span class="position">@ line 902</span></li></ul><ul id="m-action_refuse"><li>action_refuse(self) <span class="position">@ line 782</span></li></ul><ul id="m-action_validate"><li>action_validate(self) <span class="position">@ line 746</span></li></ul><ul id="m-activity_update"><li>activity_update(self) <span class="position">@ line 864</span></li></ul><ul id="m-add_follower"><li>add_follower(self, employee_id) <span class="position">@ line 649</span></li></ul><ul id="m-message_subscribe"><li>message_subscribe(self, partner_ids, subtype_ids) <span class="position">@ line 941</span></li></ul><ul id="m-onchange"><li>onchange(self, values, field_names, fields_spec) <span class="position">@ line 588</span></li></ul><ul id="m-write"><li>write(self, values) <span class="position">@ line 679</span></li></ul><script src="class.js"></script></body></html>
