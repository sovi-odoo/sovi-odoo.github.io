<!doctype html><html lang="en"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>stock.valuation.layer - odocgen</title><link rel="stylesheet" href="class.css" /></head><body><h1>stock.valuation.layer</h1><p>Originally defined in: odoo/addons/stock_account/models/stock_valuation_layer.py</p><p>Inherited in: odoo/addons/stock_landed_costs/models/stock_valuation_layer.py<br/>Inherited in: odoo/addons/purchase_stock/models/stock_valuation_layer.py<br/>Inherited in: odoo/addons/mrp_subcontracting_purchase/models/stock_valuation_layer.py<br/></p><hr/><h2>Original: odoo/addons/stock_account/models/stock_valuation_layer.py</h2><h3>Fields</h3><details><summary id="f-account_move_id">account_move_id <span class="position">@ line 32</span></summary><pre>account_move_id = fields.Many2one('account.move', 'Journal Entry', readonly=True, check_company=True, index="btree_not_null")</pre></details><details><summary id="f-account_move_line_id">account_move_line_id <span class="position">@ line 33</span></summary><pre>account_move_line_id = fields.Many2one('account.move.line', 'Invoice Line', readonly=True, check_company=True, index="btree_not_null")</pre></details><details><summary id="f-categ_id">categ_id <span class="position">@ line 19</span></summary><pre>categ_id = fields.Many2one('product.category', related='product_id.categ_id', store=True)</pre></details><details><summary id="f-company_id">company_id <span class="position">@ line 17</span></summary><pre>company_id = fields.Many2one('res.company', 'Company', readonly=True, required=True)</pre></details><details><summary id="f-currency_id">currency_id <span class="position">@ line 23</span></summary><pre>currency_id = fields.Many2one('res.currency', 'Currency', related='company_id.currency_id', readonly=True, required=True)</pre></details><details><summary id="f-description">description <span class="position">@ line 28</span></summary><pre>description = fields.Char('Description', readonly=True)</pre></details><details><summary id="f-price_diff_value">price_diff_value <span class="position">@ line 35</span></summary><pre>price_diff_value = fields.Float('Invoice value correction with invoice currency')</pre></details><details><summary id="f-product_id">product_id <span class="position">@ line 18</span></summary><pre>product_id = fields.Many2one('product.product', 'Product', readonly=True, required=True, check_company=True, auto_join=True)</pre></details><details><summary id="f-product_tmpl_id">product_tmpl_id <span class="position">@ line 20</span></summary><pre>product_tmpl_id = fields.Many2one('product.template', related='product_id.product_tmpl_id')</pre></details><details><summary id="f-quantity">quantity <span class="position">@ line 21</span></summary><pre>quantity = fields.Float('Quantity', readonly=True, digits='Product Unit of Measure')</pre></details><details><summary id="f-reference">reference <span class="position">@ line 34</span></summary><pre>reference = fields.Char(related='stock_move_id.reference')</pre></details><details><summary id="f-remaining_qty">remaining_qty <span class="position">@ line 26</span></summary><pre>remaining_qty = fields.Float(readonly=True, digits='Product Unit of Measure')</pre></details><details><summary id="f-remaining_value">remaining_value <span class="position">@ line 27</span></summary><pre>remaining_value = fields.Monetary('Remaining Value', readonly=True)</pre></details><details><summary id="f-stock_move_id">stock_move_id <span class="position">@ line 31</span></summary><pre>stock_move_id = fields.Many2one('stock.move', 'Stock Move', readonly=True, check_company=True, index=True)</pre></details><details><summary id="f-stock_valuation_layer_id">stock_valuation_layer_id <span class="position">@ line 29</span></summary><pre>stock_valuation_layer_id = fields.Many2one('stock.valuation.layer', 'Linked To', readonly=True, check_company=True, index=True)</pre></details><details><summary id="f-stock_valuation_layer_ids">stock_valuation_layer_ids <span class="position">@ line 30</span></summary><pre>stock_valuation_layer_ids = fields.One2many('stock.valuation.layer', 'stock_valuation_layer_id')</pre></details><details><summary id="f-unit_cost">unit_cost <span class="position">@ line 24</span></summary><pre>unit_cost = fields.Float('Unit Value', digits='Product Price', readonly=True, aggregator=None)</pre></details><details><summary id="f-uom_id">uom_id <span class="position">@ line 22</span></summary><pre>uom_id = fields.Many2one(related='product_id.uom_id', readonly=True, required=True)</pre></details><details><summary id="f-value">value <span class="position">@ line 25</span></summary><pre>value = fields.Monetary('Total Value', readonly=True)</pre></details><details><summary id="f-warehouse_id">warehouse_id <span class="position">@ line 36</span></summary><pre>warehouse_id = fields.Many2one('stock.warehouse', string="Receipt WH", compute='_compute_warehouse_id', search='_search_warehouse_id')</pre></details><h3>Methods</h3><ul id="m-_compute_warehouse_id"><li>_compute_warehouse_id(self) <span class="position">@ line 44</span></li></ul><details><summary id="m-_consume_all">_consume_all(self, qty_valued, valued, qty_to_value) <span class="position">@ line 162</span></summary><pre>The method consumes all svl to get the total qty/value. Then it deducts
the already consumed qty/value. Finally, it tries to consume the `qty_to_value`
The method returns the valued quantity and its valuation</pre></details><details><summary id="m-_consume_specific_qty">_consume_specific_qty(self, qty_valued, qty_to_value) <span class="position">@ line 126</span></summary><pre>Iterate on the SVL to first skip the qty already valued. Then, keep
iterating to consume `qty_to_value` and stop
The method returns the valued quantity and its valuation</pre></details><ul id="m-_search_warehouse_id"><li>_search_warehouse_id(self, operator, value) <span class="position">@ line 51</span></li></ul><ul id="m-_validate_accounting_entries"><li>_validate_accounting_entries(self) <span class="position">@ line 61</span></li></ul><ul id="m-_validate_analytic_accounting_entries"><li>_validate_analytic_accounting_entries(self) <span class="position">@ line 80</span></li></ul><ul id="m-action_open_journal_entry"><li>action_open_journal_entry(self) <span class="position">@ line 84</span></li></ul><ul id="m-action_open_reference"><li>action_open_reference(self) <span class="position">@ line 113</span></li></ul><ul id="m-action_valuation_at_date"><li>action_valuation_at_date(self) <span class="position">@ line 95</span></li></ul><ul id="m-init"><li>init(self) <span class="position">@ line 38</span></li></ul><h2>Inherited: odoo/addons/stock_landed_costs/models/stock_valuation_layer.py</h2><h3>Fields</h3><details><summary id="f-stock_landed_cost_id">stock_landed_cost_id <span class="position">@ line 10</span></summary><pre>stock_landed_cost_id = fields.Many2one('stock.landed.cost', 'Landed Cost')</pre></details><h2>Inherited: odoo/addons/purchase_stock/models/stock_valuation_layer.py</h2><h3>Methods</h3><details><summary id="m-_get_layer_price_unit">_get_layer_price_unit(self) <span class="position">@ line 7</span></summary><pre>This function returns the value of product in a layer per unit, relative to the aml
the function is designed to be overriden to add logic to price unit calculation
:param layer: the layer the price unit is derived from</pre></details><h2>Inherited: odoo/addons/mrp_subcontracting_purchase/models/stock_valuation_layer.py</h2><h3>Methods</h3><details><summary id="m-_get_layer_price_unit">_get_layer_price_unit(self) <span class="position">@ line 9</span></summary><pre>For a subcontracted product, we want a way to get the subcontracting cost (the price on the PO)
This override deducts the value of subcomponents from the layer price.</pre></details><script src="class.js"></script></body></html>
