<!doctype html><html lang="en"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>discuss.channel - odocgen</title><link rel="stylesheet" href="class.css" /></head><body><h1>discuss.channel</h1><p>Inherited in: odoo/addons/website_livechat/models/discuss_channel.py<br/>Inherited in: odoo/addons/website_crm_livechat/models/discuss_channel.py<br/>Inherited in: odoo/addons/mail_bot/models/discuss_channel.py<br/>Inherited in: odoo/addons/im_livechat/models/discuss_channel.py<br/>Inherited in: odoo/addons/hr/models/discuss_channel.py<br/>Inherited in: odoo/addons/crm_livechat/models/discuss_channel.py<br/></p><hr/><h2>Inherited: odoo/addons/website_livechat/models/discuss_channel.py</h2><h3>Fields</h3><details><summary id="f-livechat_visitor_id">livechat_visitor_id <span class="position">@ line 11</span></summary><pre>livechat_visitor_id = fields.Many2one('website.visitor', string='Visitor', index='btree_not_null')</pre></details><h3>Methods</h3><details><summary id="m-_channel_info">_channel_info(self) <span class="position">@ line 25</span></summary><pre>Override to add visitor information on the mail channel infos.
This will be used to display a banner with visitor informations
at the top of the livechat channel discussion view in discuss module.</pre></details><details><summary id="m-_get_visitor_history">_get_visitor_history(self, visitor) <span class="position">@ line 52</span></summary><pre>Prepare history string to render it in the visitor info div on discuss livechat channel view.
:param visitor: website.visitor of the channel
:return: arrow separated string containing navigation history information</pre></details><ul id="m-_get_visitor_leave_message"><li>_get_visitor_leave_message(self, operator, cancel) <span class="position">@ line 61</span></li></ul><details><summary id="m-channel_pin">channel_pin(self, pinned) <span class="position">@ line 13</span></summary><pre>Override to clean an empty livechat channel.
This is typically called when the operator send a chat request to a website.visitor
but don't speak to them and closes the chatter.
This allows operators to send the visitor a new chat request.
If active empty livechat channel,
delete discuss_channel as not useful to keep empty chat</pre></details><h2>Inherited: odoo/addons/website_crm_livechat/models/discuss_channel.py</h2><h3>Methods</h3><details><summary id="m-_convert_visitor_to_lead">_convert_visitor_to_lead(self, partner, key) <span class="position">@ line 10</span></summary><pre>When website is installed, we can link the created lead from /lead command
to the current website_visitor. We do not use the lead name as it does not correspond
to the lead contact name.</pre></details><h2>Inherited: odoo/addons/mail_bot/models/discuss_channel.py</h2><h3>Methods</h3><ul id="m-execute_command_help"><li>execute_command_help(self) <span class="position">@ line 10</span></li></ul><h2>Inherited: odoo/addons/im_livechat/models/discuss_channel.py</h2><h3>Fields</h3><details><summary id="f-anonymous_name">anonymous_name <span class="position">@ line 20</span></summary><pre>anonymous_name = fields.Char('Anonymous Name')</pre></details><details><summary id="f-channel_type">channel_type <span class="position">@ line 21</span></summary><pre>channel_type = fields.Selection(selection_add=[('livechat', 'Livechat Conversation')], ondelete={'livechat': 'cascade'})</pre></details><details><summary id="f-chatbot_current_step_id">chatbot_current_step_id <span class="position">@ line 26</span></summary><pre>chatbot_current_step_id = fields.Many2one('chatbot.script.step', string='Chatbot Current Step')</pre></details><details><summary id="f-chatbot_message_ids">chatbot_message_ids <span class="position">@ line 27</span></summary><pre>chatbot_message_ids = fields.One2many('chatbot.message', 'discuss_channel_id', string='Chatbot Messages')</pre></details><details><summary id="f-country_id">country_id <span class="position">@ line 28</span></summary><pre>country_id = fields.Many2one('res.country', string="Country", help="Country of the visitor of the channel")</pre></details><details><summary id="f-duration">duration <span class="position">@ line 22</span></summary><pre>duration = fields.Float('Duration', compute='_compute_duration', help='Duration of the session in hours')</pre></details><details><summary id="f-livechat_active">livechat_active <span class="position">@ line 23</span></summary><pre>livechat_active = fields.Boolean('Is livechat ongoing?', help='Livechat session is active until visitor leaves the conversation.')</pre></details><details><summary id="f-livechat_channel_id">livechat_channel_id <span class="position">@ line 24</span></summary><pre>livechat_channel_id = fields.Many2one('im_livechat.channel', 'Channel', index='btree_not_null')</pre></details><details><summary id="f-livechat_operator_id">livechat_operator_id <span class="position">@ line 25</span></summary><pre>livechat_operator_id = fields.Many2one('res.partner', string='Operator', index='btree_not_null')</pre></details><h3>Methods</h3><details><summary id="m-_channel_info">_channel_info(self) <span class="position">@ line 46</span></summary><pre>Extends the channel header by adding the livechat operator and the 'anonymous' profile
:rtype : list(dict)</pre></details><details><summary id="m-_chatbot_find_customer_values_in_messages">_chatbot_find_customer_values_in_messages(self, step_type_to_field) <span class="position">@ line 182</span></summary><pre>Look for user's input in the channel's messages based on a dictionary
mapping the step_type to the field name of the model it will be used on.

:param dict step_type_to_field: a dict of step types to customer fields
to fill, like : {'question_email': 'email_from', 'question_phone': 'mobile'}</pre></details><details><summary id="m-_chatbot_post_message">_chatbot_post_message(self, chatbot_script, body) <span class="position">@ line 202</span></summary><pre>Small helper to post a message as the chatbot operator

:param record chatbot_script
:param string body: message HTML body</pre></details><ul id="m-_chatbot_restart"><li>_chatbot_restart(self, chatbot_script) <span class="position">@ line 248</span></li></ul><ul id="m-_chatbot_validate_email"><li>_chatbot_validate_email(self, email_address, chatbot_script) <span class="position">@ line 215</span></li></ul><details><summary id="m-_close_livechat_session">_close_livechat_session(self) <span class="position">@ line 123</span></summary><pre>Set deactivate the livechat channel and notify (the operator) the reason of closing the session.</pre></details><ul id="m-_compute_is_chat"><li>_compute_is_chat(self) <span class="position">@ line 40</span></li></ul><ul id="m-_email_livechat_transcript"><li>_email_livechat_transcript(self, email) <span class="position">@ line 152</span></li></ul><ul id="m-_execute_command_help_message_extra"><li>_execute_command_help_message_extra(self) <span class="position">@ line 102</span></li></ul><details><summary id="m-_get_channel_history">_get_channel_history(self) <span class="position">@ line 169</span></summary><pre>Converting message body back to plaintext for correct data formatting in HTML field.</pre></details><ul id="m-_get_visitor_leave_message"><li>_get_visitor_leave_message(self, operator, cancel) <span class="position">@ line 120</span></li></ul><details><summary id="m-_message_post_after_hook">_message_post_after_hook(self, message, msg_vals) <span class="position">@ line 234</span></summary><pre>This method is called just before _notify_thread() method which is calling the _message_format()
method. We need a 'chatbot.message' record before it happens to correctly display the message.
It's created only if the mail channel is linked to a chatbot step.</pre></details><ul id="m-_rating_get_parent_field_name"><li>_rating_get_parent_field_name(self) <span class="position">@ line 149</span></li></ul><ul id="m-_send_history_message"><li>_send_history_message(self, pid, page_history) <span class="position">@ line 113</span></li></ul><ul id="m-_types_allowing_seen_infos"><li>_types_allowing_seen_infos(self) <span class="position">@ line 259</span></li></ul><ul id="m-execute_command_history"><li>execute_command_history(self) <span class="position">@ line 110</span></li></ul><h2>Inherited: odoo/addons/hr/models/discuss_channel.py</h2><h3>Fields</h3><details><summary id="f-subscription_department_ids">subscription_department_ids <span class="position">@ line 11</span></summary><pre>subscription_department_ids = fields.Many2many(
        'hr.department', string='HR Departments',
        help='Automatically subscribe members of those departments to the channel.')</pre></details><h3>Methods</h3><details><summary id="m-_subscribe_users_automatically_get_members">_subscribe_users_automatically_get_members(self) <span class="position">@ line 21</span></summary><pre>Auto-subscribe members of a department to a channel</pre></details><ul id="m-write"><li>write(self, vals) <span class="position">@ line 31</span></li></ul><h2>Inherited: odoo/addons/crm_livechat/models/discuss_channel.py</h2><h3>Methods</h3><details><summary id="m-_convert_visitor_to_lead">_convert_visitor_to_lead(self, partner, key) <span class="position">@ line 21</span></summary><pre>Create a lead from channel /lead command
:param partner: internal user partner (operator) that created the lead;
:param key: operator input in chat ('/lead Lead about Product')</pre></details><ul id="m-execute_command_lead"><li>execute_command_lead(self) <span class="position">@ line 11</span></li></ul><script src="class.js"></script></body></html>
