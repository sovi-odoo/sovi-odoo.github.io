<!doctype html><html lang="en"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>microsoft.calendar.sync - odocgen</title><link rel="stylesheet" href="class.css" /></head><body><h1>microsoft.calendar.sync</h1><p>Originally defined in: odoo/addons/microsoft_calendar/models/microsoft_sync.py</p><hr/><h2>Original: odoo/addons/microsoft_calendar/models/microsoft_sync.py</h2><h3>Fields</h3><details><summary id="f-active">active <span class="position">@ line 63</span></summary><pre>active = fields.Boolean(default=True)</pre></details><details><summary id="f-microsoft_id">microsoft_id <span class="position">@ line 58</span></summary><pre>microsoft_id = fields.Char('Organizer event Id', copy=False, index=True)</pre></details><details><summary id="f-ms_universal_event_id">ms_universal_event_id <span class="position">@ line 59</span></summary><pre>ms_universal_event_id = fields.Char('Universal event Id', copy=False, index=True)</pre></details><details><summary id="f-need_sync_m">need_sync_m <span class="position">@ line 62</span></summary><pre>need_sync_m = fields.Boolean(default=True, copy=False)</pre></details><h3>Methods</h3><ul id="m-_cancel_microsoft"><li>_cancel_microsoft(self) <span class="position">@ line 151</span></li></ul><details><summary id="m-_check_old_event_update_required">_check_old_event_update_required(self, lower_bound_day_range, update_time_diff) <span class="position">@ line 340</span></summary><pre>Checks if an old event in Odoo should be updated locally. This verification is necessary because
sometimes events in Odoo have the same state in Microsoft and even so they trigger updates locally
due to a second or less of update time difference, thus spamming unwanted emails on Microsoft side.</pre></details><ul id="m-_ensure_attendees_have_email"><li>_ensure_attendees_have_email(self) <span class="position">@ line 459</span></li></ul><details><summary id="m-_extend_microsoft_domain">_extend_microsoft_domain(self, domain) <span class="position">@ line 483</span></summary><pre>Extends the sync domain based on the full_sync_m context parameter.
In case of full sync it shouldn't include already synced events.</pre></details><details><summary id="m-_get_event_user_m">_get_event_user_m(self, user_id) <span class="position">@ line 502</span></summary><pre>Return the correct user to send the request to Microsoft.
It's possible that a user creates an event and sets another user as the organizer. Using self.env.user will
cause some issues, and it might not be possible to use this user for sending the request, so this method gets
the appropriate user accordingly.</pre></details><details><summary id="m-_get_microsoft_records_to_sync">_get_microsoft_records_to_sync(self, full_sync) <span class="position">@ line 431</span></summary><pre>Return records that should be synced from Odoo to Microsoft
:param full_sync: If True, all events attended by the user are returned
:return: events</pre></details><details><summary id="m-_get_microsoft_sync_domain">_get_microsoft_sync_domain(self) <span class="position">@ line 462</span></summary><pre>Return a domain used to search records to synchronize.
e.g. return a domain to synchronize records owned by the current user.</pre></details><details><summary id="m-_get_microsoft_synced_fields">_get_microsoft_synced_fields(self) <span class="position">@ line 469</span></summary><pre>Return a set of field names. Changing one of these fields
marks the record to be re-synchronized.</pre></details><details><summary id="m-_get_synced_events">_get_synced_events(self) <span class="position">@ line 103</span></summary><pre>Get events already synced with Microsoft Outlook.</pre></details><ul id="m-_microsoft_attendee_answer"><li>_microsoft_attendee_answer(self, answer, params, timeout) <span class="position">@ line 412</span></li></ul><details><summary id="m-_microsoft_delete">_microsoft_delete(self, user_id, event_id, timeout) <span class="position">@ line 357</span></summary><pre>Once the event has been really removed from the Odoo database, remove it from the Outlook calendar.

Note that all self attributes to use in this method must be provided as method parameters because
'self' won't exist when this method will be really called due to @after_commit decorator.</pre></details><details><summary id="m-_microsoft_insert">_microsoft_insert(self, values, timeout) <span class="position">@ line 390</span></summary><pre>Once the event has been really added in the Odoo database, add it in the Outlook calendar.

Note that all self attributes to use in this method must be provided as method parameters because
'self' may have been modified between the call of '_microsoft_insert' and its execution,
due to @after_commit decorator.</pre></details><details><summary id="m-_microsoft_patch">_microsoft_patch(self, user_id, event_id, values, timeout) <span class="position">@ line 371</span></summary><pre>Once the event has been really modified in the Odoo database, modify it in the Outlook calendar.

Note that all self attributes to use in this method must be provided as method parameters because
'self' may have been modified between the call of '_microsoft_patch' and its execution,
due to @after_commit decorator.</pre></details><details><summary id="m-_microsoft_values">_microsoft_values(self, fields_to_sync) <span class="position">@ line 451</span></summary><pre>Implements this method to return a dict with values formatted
according to the Microsoft Calendar API
:return: dict of Microsoft formatted values</pre></details><ul id="m-_sync_odoo2microsoft"><li>_sync_odoo2microsoft(self) <span class="position">@ line 123</span></li></ul><ul id="m-_sync_recurrence_microsoft2odoo"><li>_sync_recurrence_microsoft2odoo(self, microsoft_events, new_events) <span class="position">@ line 156</span></li></ul><details><summary id="m-_update_microsoft_recurrence">_update_microsoft_recurrence(self, recurrence, events) <span class="position">@ line 226</span></summary><pre>Update Odoo events from Outlook recurrence and events.</pre></details><ul id="m-_write_from_microsoft"><li>_write_from_microsoft(self, microsoft_event, vals) <span class="position">@ line 116</span></li></ul><ul id="m-unlink"><li>unlink(self) <span class="position">@ line 109</span></li></ul><ul id="m-write"><li>write(self, vals) <span class="position">@ line 65</span></li></ul><script src="class.js"></script></body></html>
